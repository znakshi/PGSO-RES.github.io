<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make a Reservation - PGSO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .pgso-blue { background-color: #3c5473; }
        .pgso-btn { background-color: #3c5473; }
        .pgso-btn:hover { background-color: #2c3e50; }
        /* Custom style for form inputs */
        .form-input { background-color: #f3f4f6; border: none; }
        .form-input:focus { background-color: #ffffff; box-shadow: 0 0 0 2px #e5e7eb; }
        /* Calendar styles */
        .cal-cell { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; user-select: none; }
        .cal-past { color: #d1d5db; cursor: not-allowed; }
        .cal-reserved { background-color: #e5e7eb; color: #9ca3af; text-decoration: line-through; cursor: not-allowed; }
        .cal-selected { background-color: #3c5473; color: white; font-weight: bold; }
        .cal-available:hover { background-color: #f3f4f6; cursor: pointer; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <nav class="bg-white border-b border-gray-200 py-4 px-6 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center gap-3">
            <a href="index.html" class="text-3xl text-slate-600 no-underline">
                <i class="fa-regular fa-building"></i>
            </a>
            <div>
                <h1 class="text-xl font-semibold tracking-tight text-gray-800">PGSO-RES</h1>
                <p class="text-xs text-gray-500 font-light">Provincial General Services Offices</p>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8 max-w-5xl">
        <a href="index.html" class="inline-flex items-center text-sm font-medium text-gray-600 mb-6 hover:text-pgso-blue transition">
            <i class="fa-solid fa-arrow-left mr-2"></i> Back to Venues
        </a>

        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8">
            <h2 class="text-2xl font-bold mb-2">Provincial Gymnasium</h2>
            <p class="text-gray-500 mb-8">Fill out the form below to reserve your venue</p>

            <form id="reservation-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-bold mb-2">Full Name *</label>
                        <input type="text" class="form-input w-full rounded-md p-3" placeholder="">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2">Contact Number *</label>
                        <input type="text" class="form-input w-full rounded-md p-3" placeholder="">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-bold mb-2">Email Address *</label>
                        <input type="email" class="form-input w-full rounded-md p-3" placeholder="e.g., juan@email.com">
                    </div>
                </div>

                <div class="mb-8">
                    <label class="block text-sm font-bold mb-2">Event Type</label>
                    <input type="text" class="form-input w-full rounded-md p-3" placeholder="e.g., Sports, Conference, Tournament">
                </div>

                <h3 class="text-lg font-bold mb-2">Duration *</h3>
                <p class="text-gray-500 mb-2">Rental of Open Gym (6:00 am to 5:00 pm Only)</p>
                <div class="space-y-3 mb-2">
                    <div class="flex items-center">
                        <input id="duration-4" name="duration" type="radio" class="w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300" data-duration-value="4">
                        <label for="duration-4" class="ml-3 font-bold text-gray-800">4 hours and below (â‚±1,500)</label>
                    </div>
                    <div class="flex items-center">
                        <input id="duration-8" name="duration" type="radio" class="w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300" data-duration-value="8">
                        <label for="duration-8" class="ml-3 font-bold text-gray-800">8 hours (â‚±2,500)</label>
                    </div>
                </div>

                <p class="text-s text-gray-500 mb-8">â‚±400 for every additional hour or a fraction thereof (if availed 4 hours only)</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div>
                        <label class="block text-sm font-bold mb-2">Start Time *</label>
                        <input type="time" class="form-input w-full rounded-md p-3 text-gray-500">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2">End Time *</label>
                        <input type="time" class="form-input w-full rounded-md p-3 text-gray-500">
                    </div>
                </div>

                <div class="mb-8">
                     <label class="block text-sm font-bold mb-4">Select Date *</label>
                     <div class="border border-gray-100 rounded-xl p-6 max-w-md mx-auto">
                        <div class="flex justify-between items-center mb-6">
                            <button type="button" id="prevMonth" class="text-gray-800 hover:bg-gray-100 p-2 rounded-full"><i class="fa-solid fa-chevron-left"></i></button>
                            <h4 id="currentMonthYear" class="text-lg font-bold">Month Year</h4>
                            <button type="button" id="nextMonth" class="text-gray-800 hover:bg-gray-100 p-2 rounded-full"><i class="fa-solid fa-chevron-right"></i></button>
                        </div>
                        
                        <div class="grid grid-cols-7 gap-2 text-center mb-4 font-bold text-gray-800">
                            <div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div>
                        </div>
                        
                        <div id="calendar-grid" class="grid grid-cols-7 gap-2 justify-items-center text-gray-700">
                            </div>

                        <div class="flex flex-wrap justify-center gap-4 mt-6 text-xs text-gray-600">
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md bg-pgso-blue mr-2"></div> Selected</div>
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md bg-gray-200 mr-2 flex justify-center items-center text-gray-400 text-[10px]"><i class="fa-solid fa-xmark"></i></div> Reserved</div>
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md text-gray-300 mr-2 flex justify-center items-center text-[10px]"><i class="fa-solid fa-xmark"></i></div> Past Date</div>
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md border border-gray-200 mr-2"></div> Available</div>
                        </div>
                     </div>
                </div>

                <h3 class="text-lg font-bold mb-4">Other Equipment</h3>
                <div class="overflow-x-auto mb-8">
                    <table class="min-w-full text-sm text-left text-gray-500" id="equipment-table">
                        <thead class="text-xs text-gray-700 uppercase border-b">
                            <tr>
                                <th scope="col" class="p-4">Select</th>
                                <th scope="col" class="py-3">Equipment Name</th>
                                <th scope="col" class="py-3">Unit</th>
                                <th scope="col" class="py-3">Price</th>
                                <th scope="col" class="py-3 w-24">Quantity</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            <tr data-price="5500" data-unit="day">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Boxing Ring Paraphernalia</td>
                                <td class="py-3">per day</td>
                                <td class="py-3 text-gray-900">â‚±5,500</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="100" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Folding Tables</td>
                                <td class="py-3">per table, per day</td>
                                <td class="py-3 text-gray-900">â‚±100</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="7.5" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Monoblock Chairs</td>
                                <td class="py-3">per chair, per day</td>
                                <td class="py-3 text-gray-900">â‚±7.5</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="20" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Monoblock Tables</td>
                                <td class="py-3">per table, per day</td>
                                <td class="py-3 text-gray-900">â‚±20</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="500" data-unit="day">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Parachute Tent</td>
                                <td class="py-3">per day</td>
                                <td class="py-3 text-gray-900">â‚±500</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="1500" data-unit="day">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Red Carpet</td>
                                <td class="py-3">per day</td>
                                <td class="py-3 text-gray-900">â‚±1,500</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="200" data-unit="hour">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Sound System: 2 microphones and 2 speakers</td>
                                <td class="py-3">per hour</td>
                                <td class="py-3 text-gray-900">â‚±200</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="25" data-unit="hour">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Microphones</td>
                                <td class="py-3">per hour</td>
                                <td class="py-3 text-gray-900">â‚±25</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="70" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Table Cloths</td>
                                <td class="py-3">per cloth, per day</td>
                                <td class="py-3 text-gray-900">â‚±70</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="25" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Table Runners</td>
                                <td class="py-3">per cloth, per day</td>
                                <td class="py-3 text-gray-900">â‚±25</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="text-s text-gray-500 mt-2 text-center font-light">Note: Actual/Additional electricity consumption will be charged based on the computations made by the personnel in charge.</p>
                </div>

                <div class="mb-8">
                    <label class="block text-sm font-bold mb-2">Notes / Remarks (Optional)</label>
                    <textarea class="form-input w-full rounded-md p-3 h-24 resize-none" placeholder="Any special requests or additional information..."></textarea>
                </div>

                <div class="bg-slate-100 rounded-lg p-6 mb-8">
                    <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Venue Base Price:</span>
                        <span id="base-price-display" class="font-medium">â‚±0</span>
                    </div>
                    <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Total Days Reserved:</span>
                        <span id="days-reserved-display" class="font-medium">0 days</span>
                    </div>
                     <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Total Equipment Cost:</span>
                        <span id="equipment-cost-display" class="font-medium">â‚±0</span>
                    </div>
                    <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Sub-Total (Venue x Days + Equip.):</span>
                        <span id="subtotal-display" class="font-medium">â‚±0</span>
                    </div>
                    <div class="flex justify-between text-sm mb-4 text-gray-700 border-b border-gray-300 pb-4">
                        <span>Security Deposit (Refundable):</span>
                        <span class="font-medium">â‚±3,000</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-xl font-bold text-gray-800">Estimated Total:</span>
                        <span id="estimated-total-display" class="text-3xl font-bold text-pgso-blue">â‚±3,000</span>
                    </div>
                    <p class="text-xs text-gray-500 mt-4">Note: Final pricing may vary based on actual hours and equipment usage. Contact PGSO for detailed quotes.</p>
                </div>

                <button type="button" class="w-full pgso-btn text-white font-bold py-4 rounded-lg text-lg transition shadow-md">
                    View Reservation Summary
                </button>

            </form>
        </div>
    </main>

    <footer class="text-center py-8 text-gray-400 text-sm">
        &copy; 2025 Provincial General Services Office. All rights reserved.
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- CONFIGURATION ---
        const OVERTIME_RATE = 400; 
        const SECURITY_DEPOSIT = 3000;
        const VENUE_NAME = "Provincial Gymnasium";
        
        // --- ðŸ›‘ SIMULATED DATABASE OF RESERVED DATES ðŸ›‘ ---
        // Format: YYYY-MM-DD. These dates will appear blocked on the calendar.
        const BLOCKED_DATES = [
            "2025-11-20", 
            "2025-11-25",
            "2025-12-25",
            "2025-12-31" 
        ];

        // --- SELECTORS ---
        const allTextInputs = document.querySelectorAll('input[type="text"]');
        const nameInput = allTextInputs[0]; 
        const contactInput = allTextInputs[1]; 
        const eventTypeInput = allTextInputs[2];
        const emailInput = document.querySelector('input[type="email"]');
        const notesInput = document.querySelector('textarea');
        
        // Time & Duration
        const durationRadios = document.getElementsByName('duration');
        const startTimeInput = document.querySelectorAll('input[type="time"]')[0];
        const endTimeInput = document.querySelectorAll('input[type="time"]')[1];

        // Calendar Elements
        const calendarGrid = document.getElementById('calendar-grid');
        const currentMonthYear = document.getElementById('currentMonthYear');
        const prevMonthBtn = document.getElementById('prevMonth');
        const nextMonthBtn = document.getElementById('nextMonth');

        // Display Elements
        const displayBasePrice = document.getElementById('base-price-display');
        const displayDays = document.getElementById('days-reserved-display');
        const displayEquipCost = document.getElementById('equipment-cost-display');
        const displaySubtotal = document.getElementById('subtotal-display');
        const displayTotal = document.getElementById('estimated-total-display');
        const summaryBtn = document.querySelector('button.pgso-btn');
        const equipmentRows = document.querySelectorAll('#equipment-table tbody tr'); 

        // --- STATE VARIABLES ---
        let currentDate = new Date(); // The month being viewed
        let today = new Date(); // Today's actual date
        let selectedDates = []; // User selected dates (YYYY-MM-DD)

        // --- 1. CALENDAR LOGIC ---

        function renderCalendar() {

            calendarGrid.innerHTML = ""; // Clear grid
            
            // Set Header
            const options = { month: 'long', year: 'numeric' };
            currentMonthYear.innerText = currentDate.toLocaleDateString('en-US', options);

            const year = currentDate.getFullYear();
            const month = currentDate.getMonth(); 
            
            const firstDayOfMonth = new Date(year, month, 1).getDay(); // 0(Sun)-6(Sat)
            const daysInMonth = new Date(year, month + 1, 0).getDate(); 

            // Empty cells before 1st of month
            for (let i = 0; i < firstDayOfMonth; i++) {
                const emptyCell = document.createElement('div');
                calendarGrid.appendChild(emptyCell);
            }

            // Generate Days
            for (let i = 1; i <= daysInMonth; i++) {
                const dayCell = document.createElement('div');
                dayCell.classList.add('cal-cell');
                dayCell.innerText = i;

                // Format: YYYY-MM-DD
                const cellDateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                
                // Compare logic (Time reset to 00:00:00 for accurate day comparison)
                const cellDateObj = new Date(year, month, i);
                const compareDate = new Date(cellDateObj.setHours(0,0,0,0));
                const compareToday = new Date(today.setHours(0,0,0,0));

                if (compareDate < compareToday) {
                    // Past Date
                    dayCell.classList.add('cal-past');
                } else if (BLOCKED_DATES.includes(cellDateStr)) {
                    // Reserved Date
                    dayCell.classList.add('cal-reserved');
                    dayCell.title = "Already Reserved";
                } else {
                    // Available
                    dayCell.classList.add('cal-available');
                    
                    // Maintain selection state if user navigates months
                    if (selectedDates.includes(cellDateStr)) {
                        dayCell.classList.add('cal-selected');
                    }

                    dayCell.addEventListener('click', function() {
                        if (selectedDates.includes(cellDateStr)) {
                            selectedDates = selectedDates.filter(d => d !== cellDateStr);
                            this.classList.remove('cal-selected');
                        } else {
                            selectedDates.push(cellDateStr);
                            this.classList.add('cal-selected');
                        }
                        calculateTotal();
                    });
                }
                calendarGrid.appendChild(dayCell);
            }
        }

        prevMonthBtn.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });

        nextMonthBtn.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });

        // --- 2. CALCULATION LOGIC ---

        function calculateTotal() {
            const totalDays = selectedDates.length > 0 ? selectedDates.length : 0;
            
            // Base Duration & Price
            let selectedBaseDuration = 0;
            let selectedBasePrice = 0;
            let durationLabel = ""; 

            const selectedRadio = document.querySelector('input[name="duration"]:checked');
            if (selectedRadio) {
                selectedBaseDuration = parseInt(selectedRadio.dataset.durationValue);
                durationLabel = selectedRadio.nextElementSibling.innerText.trim();
                selectedBasePrice = selectedBaseDuration === 4 ? 1500 : 2500;
            }

            // Hours & Overtime
            let hoursDuration = selectedBaseDuration; 
            let overtimeCost = 0;

            if (startTimeInput.value && endTimeInput.value) {
                const start = new Date(`1970-01-01T${startTimeInput.value}Z`);
                const end = new Date(`1970-01-01T${endTimeInput.value}Z`);
                let diffMs = end - start;
                if (diffMs < 0) diffMs += 24 * 60 * 60 * 1000; 
                
                const exactHours = diffMs / (1000 * 60 * 60);
                if(exactHours > 0) hoursDuration = exactHours;

                if (hoursDuration > selectedBaseDuration && selectedBaseDuration > 0) {
                    const extraHours = Math.ceil(hoursDuration - selectedBaseDuration);
                    overtimeCost = extraHours * OVERTIME_RATE;
                }
            }

            const venueTotalPerDay = selectedBasePrice + overtimeCost;
            const totalVenueCost = venueTotalPerDay * (totalDays || 1); 

            // Equipment Costs
            let totalEquipmentCost = 0;

            equipmentRows.forEach(row => {
                const checkbox = row.querySelector('.equipment-checkbox');
                const qtyInput = row.querySelector('.equipment-quantity');
                
                if (checkbox && checkbox.checked) {
                    const price = parseFloat(row.dataset.price);
                    const unitType = row.dataset.unit;
                    const qty = parseInt(qtyInput.value) || 0;
                    let itemTotal = 0;

                    if (unitType.includes('hour')) {
                        const billingHours = Math.ceil(hoursDuration) > 0 ? Math.ceil(hoursDuration) : 1;
                        itemTotal = price * qty * billingHours * (totalDays || 1);
                    } else {
                        itemTotal = price * qty * (totalDays || 1);
                    }
                    totalEquipmentCost += itemTotal;
                }
            });

            // Totals
            const displayVenue = totalDays === 0 ? 0 : totalVenueCost;
            const displayEquip = totalDays === 0 ? 0 : totalEquipmentCost;
            const subTotal = displayVenue + displayEquip;
            const grandTotal = subTotal + SECURITY_DEPOSIT;

            // UI Updates
            displayDays.textContent = `${totalDays} day(s)`;
            
            if(overtimeCost > 0) {
                 displayBasePrice.innerHTML = `â‚±${(selectedBasePrice * (totalDays||1)).toLocaleString()} <span class="text-xs text-red-500">(+â‚±${(overtimeCost * (totalDays||1)).toLocaleString()} Overtime)</span>`;
            } else {
                 displayBasePrice.textContent = `â‚±${displayVenue.toLocaleString()}`;
            }

            displayEquipCost.textContent = `â‚±${displayEquip.toLocaleString()}`;
            displaySubtotal.textContent = `â‚±${subTotal.toLocaleString()}`;
            displayTotal.textContent = `â‚±${grandTotal.toLocaleString()}`;

            return {
                totalVenueCost,
                totalEquipmentCost,
                grandTotal,
                hoursDuration,
                durationLabel,
                totalDays
            };
        }

        // Listeners
        durationRadios.forEach(r => r.addEventListener('change', calculateTotal));
        startTimeInput.addEventListener('change', calculateTotal);
        endTimeInput.addEventListener('change', calculateTotal);

        equipmentRows.forEach(row => {
            const checkbox = row.querySelector('.equipment-checkbox');
            const qtyInput = row.querySelector('.equipment-quantity');

            if(checkbox && qtyInput) {
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        qtyInput.disabled = false;
                        qtyInput.value = 1; 
                    } else {
                        qtyInput.disabled = true;
                        qtyInput.value = 0;
                    }
                    calculateTotal();
                });
                qtyInput.addEventListener('input', calculateTotal);
            }
        });

        // --- 3. SAVE AND REDIRECT ---
        summaryBtn.addEventListener('click', function(e) {
            e.preventDefault(); 
            const calcData = calculateTotal();

            const contactInfo = {
                fullName: nameInput.value || "N/A",
                contactNumber: contactInput.value || "N/A",
                email: emailInput.value || "N/A"
            };

            const eventDetails = {
                venue: VENUE_NAME,
                eventType: eventTypeInput.value || "N/A",
                dates: selectedDates.sort().join(', '),
                startTime: startTimeInput.value,
                endTime: endTimeInput.value,
                durationLabel: calcData.durationLabel,
                totalHours: Math.ceil(calcData.hoursDuration)
            };

            let equipmentList = [];
            equipmentRows.forEach(row => {
                const checkbox = row.querySelector('.equipment-checkbox');
                const qtyInput = row.querySelector('.equipment-quantity');
                
                if (checkbox && checkbox.checked) {
                    const name = row.cells[1].innerText.trim();
                    const unitText = row.cells[2].innerText.trim();
                    const price = parseFloat(row.dataset.price);
                    const unitType = row.dataset.unit;
                    const qty = parseInt(qtyInput.value);
                    
                    let itemSubtotal = 0;
                    const days = calcData.totalDays || 1;
                    
                    if (unitType.includes('hour')) {
                        const billingHours = Math.ceil(calcData.hoursDuration) > 0 ? Math.ceil(calcData.hoursDuration) : 1;
                        itemSubtotal = price * qty * billingHours * days;
                    } else {
                        itemSubtotal = price * qty * days;
                    }

                    equipmentList.push({
                        name: name,
                        unit: unitText,
                        qty: qty,
                        price: price,
                        subtotal: itemSubtotal
                    });
                }
            });

            const reservationData = {
                contact: contactInfo,
                event: eventDetails,
                equipment: equipmentList,
                pricing: {
                    venueTotal: calcData.totalVenueCost,
                    equipmentTotal: calcData.totalEquipmentCost,
                    securityDeposit: SECURITY_DEPOSIT,
                    grandTotal: calcData.grandTotal
                },
                notes: notesInput.value
            };

            localStorage.setItem('pgsoReservationData', JSON.stringify(reservationData));
            window.location.href = 'summary.html';
        });

        // Initialize
        renderCalendar();
        calculateTotal();
    });
    </script>
</body>
</html>