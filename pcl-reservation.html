<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make a Reservation - PGSO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .pgso-blue { background-color: #3c5473; }
        .pgso-btn { background-color: #3c5473; }
        .pgso-btn:hover { background-color: #2c3e50; }
        .form-input { background-color: #f3f4f6; border: none; }
        .form-input:focus { background-color: #ffffff; box-shadow: 0 0 0 2px #e5e7eb; }
        /* Calendar styles */
        .cal-cell { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.2s; }
        .cal-past { color: #d1d5db; cursor: not-allowed; }
        .cal-reserved { background-color: #e5e7eb; color: #9ca3af; text-decoration: line-through; cursor: not-allowed; }
        /* Active selected state */
        .cal-selected { background-color: #3c5473 !important; color: white !important; font-weight: bold; transform: scale(1.1); }
        .cal-available:hover { background-color: #e2e8f0; cursor: pointer; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <nav class="bg-white border-b border-gray-200 py-4 px-6 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center gap-3">
            <a href="index.html" class="text-3xl text-slate-600 no-underline">
                <i class="fa-regular fa-building"></i>
            </a>
            <div>
                <h1 class="text-xl font-semibold tracking-tight text-gray-800">PGSO-RES</h1>
                <p class="text-xs text-gray-500 font-light">PCL Hall</p>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8 max-w-5xl">
        <a href="index.html" class="inline-flex items-center text-sm font-medium text-gray-600 mb-6 hover:text-pgso-blue transition">
            <i class="fa-solid fa-arrow-left mr-2"></i> Back to Venues
        </a>

        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8">
            <h2 class="text-2xl font-bold mb-2">PCL Hall</h2>
            <p class="text-gray-500 mb-8">Fill out the form below to reserve your venue</p>

            <form id="reservation-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-bold mb-2">Full Name *</label>
                        <input type="text" class="form-input w-full rounded-md p-3" placeholder="">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2">Contact Number *</label>
                        <input type="text" class="form-input w-full rounded-md p-3" placeholder="">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-bold mb-2">Email Address *</label>
                        <input type="email" class="form-input w-full rounded-md p-3" placeholder="e.g., juan@email.com">
                    </div>
                </div>

                <div class="mb-8">
                    <label class="block text-sm font-bold mb-2">Event Type</label>
                    <input type="text" class="form-input w-full rounded-md p-3" placeholder="e.g., Wedding, Conference, Birthday">
                </div>

                <h3 class="text-lg font-bold mb-2">Duration *</h3>
                <p class="text-gray-500 mb-2">Rental of Open Gym (6:00 am to 5:00 pm Only)</p>
                <div class="space-y-3 mb-2">
                    <div class="flex items-center">
                        <input id="duration-4" name="duration" type="radio" value="4" class="calculation-trigger w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300" checked>
                        <label for="duration-4" class="ml-3 font-bold text-gray-800">4 hours and below (₱1,500)</label>
                    </div>
                    <div class="flex items-center">
                        <input id="duration-8" name="duration" type="radio" value="8" class="calculation-trigger w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300">
                        <label for="duration-8" class="ml-3 font-bold text-gray-800">8 hours (2,500)</label>
                    </div>
                </div>

                <p class="text-s text-gray-500 mb-8">₱400 for every additional hour or a fraction thereof (if availed 4 hours only)</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div>
                        <label class="block text-sm font-bold mb-2">Start Time *</label>
                        <input type="time" id="start-time" class="calculation-trigger form-input w-full rounded-md p-3 text-gray-500">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2">End Time *</label>
                        <input type="time" id="end-time" class="calculation-trigger form-input w-full rounded-md p-3 text-gray-500">
                    </div>
                </div>

                <div class="mb-8">
                     <label class="block text-sm font-bold mb-4">Select Date *</label>
                     <input type="hidden" id="selected-date-input" name="date">
                     <div class="border border-gray-100 rounded-xl p-6 max-w-md mx-auto">
                        <div class="flex justify-between items-center mb-6">
                            <button type="button" class="text-gray-800 hover:bg-gray-100 p-2 rounded-full"><i class="fa-solid fa-chevron-left"></i></button>
                            <h4 class="text-lg font-bold">November 2025</h4>
                            <button type="button" class="text-gray-800 hover:bg-gray-100 p-2 rounded-full"><i class="fa-solid fa-chevron-right"></i></button>
                        </div>
                        
                        <div class="grid grid-cols-7 gap-2 text-center mb-4 font-bold text-gray-800">
                            <div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div>
                        </div>
                        <div class="grid grid-cols-7 gap-2 justify-items-center text-gray-700" id="calendar-grid">
                            <div class="cal-cell cal-past">26</div><div class="cal-cell cal-past">27</div><div class="cal-cell cal-past">28</div><div class="cal-cell cal-past">29</div><div class="cal-cell cal-past">30</div><div class="cal-cell cal-past">31</div>
                            <div class="cal-cell cal-available" data-day="1">1</div>
                            <div class="cal-cell cal-available" data-day="2">2</div><div class="cal-cell cal-available" data-day="3">3</div><div class="cal-cell cal-available" data-day="4">4</div><div class="cal-cell cal-available" data-day="5">5</div><div class="cal-cell cal-available" data-day="6">6</div><div class="cal-cell cal-available" data-day="7">7</div><div class="cal-cell cal-available" data-day="8">8</div>
                            <div class="cal-cell cal-available" data-day="9">9</div><div class="cal-cell cal-available" data-day="10">10</div><div class="cal-cell cal-available" data-day="11">11</div>
                            <div class="cal-cell cal-available" data-day="12">12</div> <div class="cal-cell cal-available" data-day="13">13</div><div class="cal-cell cal-available" data-day="14">14</div><div class="cal-cell cal-available" data-day="15">15</div>
                             <div class="cal-cell cal-available" data-day="16">16</div><div class="cal-cell cal-available" data-day="17">17</div><div class="cal-cell cal-available" data-day="18">18</div><div class="cal-cell cal-reserved">19</div><div class="cal-cell cal-reserved">20</div><div class="cal-cell cal-available" data-day="21">21</div><div class="cal-cell cal-available" data-day="22">22</div>
                             <div class="cal-cell cal-available" data-day="23">23</div><div class="cal-cell cal-available" data-day="24">24</div><div class="cal-cell cal-available" data-day="25">25</div><div class="cal-cell cal-available" data-day="26">26</div><div class="cal-cell cal-available" data-day="27">27</div><div class="cal-cell cal-available" data-day="28">28</div><div class="cal-cell cal-available" data-day="29">29</div>
                             <div class="cal-cell cal-available" data-day="30">30</div>
                             <div class="cal-cell cal-past text-gray-300">1</div><div class="cal-cell cal-past text-gray-300">2</div><div class="cal-cell cal-past text-gray-300">3</div><div class="cal-cell cal-past text-gray-300">4</div><div class="cal-cell cal-past text-gray-300">5</div><div class="cal-cell cal-past text-gray-300">6</div>
                        </div>

                        <div class="flex flex-wrap justify-center gap-4 mt-6 text-xs text-gray-600">
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md bg-pgso-blue mr-2"></div> Selected Date</div>
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md bg-gray-200 mr-2 flex justify-center items-center text-gray-400 text-[10px]"><i class="fa-solid fa-xmark"></i></div> Reserved</div>
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md text-gray-300 mr-2 flex justify-center items-center text-[10px]"><i class="fa-solid fa-xmark"></i></div> Past Date</div>
                            <div class="flex items-center"><div class="w-4 h-4 rounded-md border border-gray-200 mr-2"></div> Available</div>
                        </div>
                     </div>
                </div>

                <h3 class="text-lg font-bold mb-4">Other Equipment</h3>
                <div class="overflow-x-auto mb-8">
                    <table class="min-w-full text-sm text-left text-gray-500" id="equipment-table">
                        <thead class="text-xs text-gray-700 uppercase border-b">
                            <tr>
                                <th scope="col" class="p-4">Select</th>
                                <th scope="col" class="py-3">Equipment Name</th>
                                <th scope="col" class="py-3">Unit</th>
                                <th scope="col" class="py-3">Price</th>
                                <th scope="col" class="py-3 w-24">Quantity</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            <tr data-price="5500" data-unit="day">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Boxing Ring Paraphernalia</td>
                                <td class="py-3">per day</td>
                                <td class="py-3 text-gray-900">₱5,500</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="100" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Folding Tables</td>
                                <td class="py-3">per table, per day</td>
                                <td class="py-3 text-gray-900">₱100</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="7.5" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Monoblock Chairs</td>
                                <td class="py-3">per chair, per day</td>
                                <td class="py-3 text-gray-900">₱7.50</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="20" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Monoblock Tables</td>
                                <td class="py-3">per table, per day</td>
                                <td class="py-3 text-gray-900">₱20</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="500" data-unit="day">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Parachute Tent</td>
                                <td class="py-3">per day</td>
                                <td class="py-3 text-gray-900">₱500</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="1500" data-unit="day">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Red Carpet</td>
                                <td class="py-3">per day</td>
                                <td class="py-3 text-gray-900">₱1,500</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="200" data-unit="hour">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Sound System</td>
                                <td class="py-3">per hour</td>
                                <td class="py-3 text-gray-900">₱200</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="25" data-unit="hour">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Microphones</td>
                                <td class="py-3">per hour</td>
                                <td class="py-3 text-gray-900">₱25</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="70" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Table Cloths</td>
                                <td class="py-3">per cloth, per day</td>
                                <td class="py-3 text-gray-900">₱70</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                            <tr data-price="25" data-unit="per_day_per_chair">
                                <td class="p-4"><input type="checkbox" name="equipment" class="equipment-checkbox w-4 h-4 text-pgso-blue bg-gray-100 border-gray-300 rounded"></td>
                                <td class="py-3 font-medium text-gray-900">Table Runners</td>
                                <td class="py-3">per cloth, per day</td>
                                <td class="py-3 text-gray-900">₱25</td>
                                <td class="py-3"><input type="number" min="0" value="0" class="equipment-quantity form-input w-full rounded p-1 text-center" disabled></td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="text-s text-gray-500 mt-2 text-center font-light">Inclusive of sound system and projector(per day)</p>
                </div>

                <div class="mb-8">
                    <label class="block text-sm font-bold mb-2">Notes / Remarks (Optional)</label>
                    <textarea class="form-input w-full rounded-md p-3 h-24 resize-none" placeholder="Any special requests or additional information..."></textarea>
                </div>

                <div class="bg-slate-100 rounded-lg p-6 mb-8">
                    <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Venue Base Price (<span id="hours-calculated-display">4 hrs</span>):</span>
                        <span id="base-price-display" class="font-medium">₱1,500</span>
                    </div>
                    <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Total Days Reserved:</span>
                        <span id="days-reserved-display" class="font-medium">0 days</span>
                    </div>
                     <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Total Equipment Cost:</span>
                        <span id="equipment-cost-display" class="font-medium">₱0</span>
                    </div>
                    <div class="flex justify-between text-sm mb-2 text-gray-700">
                        <span>Sub-Total:</span>
                        <span id="subtotal-display" class="font-medium">₱0</span>
                    </div>
                    <div class="flex justify-between text-sm mb-4 text-gray-700 border-b border-gray-300 pb-4">
                        <span>Security Deposit (Refundable):</span>
                        <span class="font-medium">₱3,000</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-xl font-bold text-gray-800">Estimated Total:</span>
                        <span id="estimated-total-display" class="text-3xl font-bold text-pgso-blue">₱4,500</span>
                    </div>
                    <p class="text-xs text-gray-500 mt-4">Note: Final pricing may vary based on actual hours and equipment usage.</p>
                </div>

                <button onclick="saveAndRedirect()" type="button" class="w-full pgso-btn text-white font-bold py-4 rounded-lg text-lg transition shadow-md">
                View Reservation Summary
                </button>

            </form>
        </div>
    </main>

    <footer class="text-center py-8 text-gray-400 text-sm">
        &copy; 2025 Provincial General Services Office. All rights reserved.
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- VARIABLES & SELECTORS ---
            const form = document.getElementById('reservation-form');
            const checkboxes = document.querySelectorAll('.equipment-checkbox');
            const quantityInputs = document.querySelectorAll('.equipment-quantity');
            const durationRadios = document.querySelectorAll('input[name="duration"]');
            const startTimeInput = document.getElementById('start-time');
            const endTimeInput = document.getElementById('end-time');
            const calendarCells = document.querySelectorAll('.cal-available');
            const selectedDateInput = document.getElementById('selected-date-input');

            // Display Spans
            const basePriceDisplay = document.getElementById('base-price-display');
            const hoursCalculatedDisplay = document.getElementById('hours-calculated-display');
            const daysReservedDisplay = document.getElementById('days-reserved-display');
            const equipCostDisplay = document.getElementById('equipment-cost-display');
            const subtotalDisplay = document.getElementById('subtotal-display');
            const estimatedTotalDisplay = document.getElementById('estimated-total-display');

            let selectedDaysCount = 0; // Starts at 0, user must click
            const securityDeposit = 3000;

            // --- 1. CALENDAR LOGIC ---
            calendarCells.forEach(cell => {
                cell.addEventListener('click', function() {
                    // Visual Toggle for single date selection
                    // Remove selected class from all
                    calendarCells.forEach(c => c.classList.remove('cal-selected'));
                    
                    // Add to clicked
                    this.classList.add('cal-selected');
                    
                    // Update state
                    selectedDaysCount = 1;
                    const day = this.getAttribute('data-day');
                    selectedDateInput.value = `2025-11-${day.padStart(2, '0')}`;
                    
                    calculateTotal();
                });
            });

            // --- 2. EQUIPMENT LOGIC ---
            checkboxes.forEach((checkbox, index) => {
                checkbox.addEventListener('change', function() {
                    const qtyInput = quantityInputs[index];
                    if (this.checked) {
                        qtyInput.disabled = false;
                        qtyInput.value = 1; // Default to 1
                        qtyInput.focus();
                    } else {
                        qtyInput.disabled = true;
                        qtyInput.value = 0;
                    }
                    calculateTotal();
                });
            });

            // Listen for quantity changes
            quantityInputs.forEach(input => {
                input.addEventListener('input', calculateTotal);
            });

            // --- 3. DURATION & TIME LOGIC ---
            // Listen to any changes in time or duration radio buttons
            const calculationTriggers = document.querySelectorAll('.calculation-trigger');
            calculationTriggers.forEach(el => {
                el.addEventListener('change', calculateTotal);
                el.addEventListener('input', calculateTotal);
            });

            // --- MAIN CALCULATION FUNCTION ---
            function calculateTotal() {
                // A. Get Base Duration Config
                let selectedBaseDuration = 4;
                durationRadios.forEach(r => {
                    if (r.checked) selectedBaseDuration = parseInt(r.value);
                });

                // B. Calculate Actual Time Difference
                let calculatedHours = selectedBaseDuration; // Default to radio selection
                let extraCharge = 0;

                if (startTimeInput.value && endTimeInput.value) {
                    const start = new Date(`1970-01-01T${startTimeInput.value}:00`);
                    const end = new Date(`1970-01-01T${endTimeInput.value}:00`);
                    
                    // Handle overnight or simple diff
                    let diffMs = end - start;
                    if (diffMs < 0) diffMs += 24 * 60 * 60 * 1000; // end time is next day? (assuming same day for now)
                    
                    const diffHours = diffMs / (1000 * 60 * 60);
                    
                    // If user input specific times, use that for equipment hourly calc
                    if(diffHours > 0) calculatedHours = diffHours;

                    // Overage Logic for 4-hour package
                    if (selectedBaseDuration === 4 && diffHours > 4) {
                        const excessHours = Math.ceil(diffHours - 4); // "Or fraction thereof" -> Math.ceil
                        extraCharge = excessHours * 400;
                    }
                }

                // C. Venue Cost
                let venueBaseCost = (selectedBaseDuration === 4) ? 1500 : 2500;
                let totalVenueCost = venueBaseCost + extraCharge;
                
                // If 0 days selected, venue cost is effectively 0 for the Total, 
                // but we usually show the rate. Let's multiply by days.
                let finalVenueCost = totalVenueCost * (selectedDaysCount > 0 ? selectedDaysCount : 0);

                // D. Equipment Cost
                let totalEquipCost = 0;
                const rows = document.querySelectorAll('#equipment-table tbody tr');
                
                rows.forEach((row) => {
                    const checkbox = row.querySelector('.equipment-checkbox');
                    const qtyInput = row.querySelector('.equipment-quantity');
                    
                    if (checkbox.checked) {
                        const price = parseFloat(row.getAttribute('data-price'));
                        const unit = row.getAttribute('data-unit'); // 'day', 'hour', or 'per_day_per_chair'
                        const qty = parseInt(qtyInput.value) || 0;
                        
                        let itemCost = 0;
                        
                        if (unit === 'hour') {
                            // Price * Qty * Hours (calculated from time inputs)
                            // We use Math.ceil for hours because you usually pay for the full hour started
                            const billingHours = Math.ceil(calculatedHours); 
                            itemCost = price * qty * billingHours;
                        } else {
                            // 'day' or 'per_day_per_chair' -> Price * Qty
                            itemCost = price * qty;
                        }
                        
                        // Multiply by days reserved
                        // If days is 0 (no selection), we assume 1 for pricing preview, 
                        // OR strictly 0. Let's do strictly * days if selected, else * 1 for preview?
                        // Better to stick to strict totals.
                        itemCost = itemCost * (selectedDaysCount > 0 ? selectedDaysCount : 0);
                        
                        totalEquipCost += itemCost;
                    }
                });

                // E. Final Totals
                const subTotal = finalVenueCost + totalEquipCost;
                // Only add security deposit if a reservation is actually happening (days > 0)
                const grandTotal = (selectedDaysCount > 0) ? (subTotal + securityDeposit) : 3000; 

                // --- UI UPDATES ---
                // Format numbers to currency
                const fmt = (num) => '₱' + num.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 2});

                hoursCalculatedDisplay.textContent = Math.ceil(calculatedHours) + " hrs";
                basePriceDisplay.textContent = (extraCharge > 0) 
                    ? `${fmt(venueBaseCost)} + ${fmt(extraCharge)} (overage)` 
                    : fmt(venueBaseCost);
                
                daysReservedDisplay.textContent = selectedDaysCount + " days";
                equipCostDisplay.textContent = fmt(totalEquipCost);
                subtotalDisplay.textContent = fmt(subTotal);
                estimatedTotalDisplay.textContent = fmt(grandTotal);
            }

            // Initial run to set zeros
            calculateTotal();

            // --- Function to SAVE data to Local Storage and redirect ---

            function saveAndRedirect() {
                function saveAndRedirect() {
                    console.log("Function called, redirecting..."); // Check your browser console for this

                 // **This is the ONLY line required to navigate**
                window.location.href = 'summary.html'; 
}
        // 1. Collect all non-calculated input fields
        const contactInfo = {
        fullName: document.querySelector('input[placeholder=""]').value, // Assuming the first is name
        contactNumber: document.querySelector('input[type="text"]:nth-child(2)').value, // Assuming the second is contact number
        email: document.querySelector('input[type="email"]').value,
    };

    const eventDetails = {
        venue: 'PCL Hall', // Hardcoded from the HTML context
        eventType: document.querySelector('input[placeholder*="Wedding"]').value,
        date: document.getElementById('selected-date-input').value, // From calendar logic
        startTime: document.getElementById('start-time').value,
        endTime: document.getElementById('end-time').value,
        durationText: document.querySelector('input[name="duration"]:checked').nextElementSibling.textContent.split('(')[0].trim(),
    };
    
    const notes = document.querySelector('textarea').value;

    // 2. Collect calculated Equipment data
    let equipmentData = [];
    let totalEquipmentCost = 0;
    const rows = document.querySelectorAll('#equipment-table tbody tr');

    rows.forEach((row) => {
        const checkbox = row.querySelector('.equipment-checkbox');
        const qtyInput = row.querySelector('.equipment-quantity');
        
        if (checkbox.checked && parseInt(qtyInput.value) > 0) {
            const price = parseFloat(row.getAttribute('data-price'));
            const unit = row.querySelector('td:nth-child(3)').textContent.trim();
            const name = row.querySelector('td:nth-child(2)').textContent.trim();
            const qty = parseInt(qtyInput.value);

            // Recalculate cost for summary consistency
            // NOTE: You would need the calculated hours here if any items are hourly.
            // For simplicity, we assume we use the calculated values already shown in the UI.
            // A quick re-calculation ensures data integrity:
            
            // Placeholder: Call calculateTotal to ensure all pricing spans are up to date
            // Assuming calculateTotal() from the previous response runs successfully:
            // calculateTotal(); 
            
            // Calculate item subtotal based on simple unit model for summary:
            // This is a simplified calculation for storage; a full implementation 
            // would need to replicate the exact hourly/daily logic here.
            
            // For now, let's pull the total cost values from the display spans:
            // It's safer to rely on the current total costs if they are accurate.
            
            // Since `calculateTotal` is complex, we'll store the item details
            // and rely on the UI to calculate and update the total cost spans
            // which we'll pull into the `pricing` object.

            // To calculate the subtotal exactly, you'll need the duration (in hours) here again:
            let calculatedHours = 4; // default
            if (document.getElementById('start-time').value && document.getElementById('end-time').value) {
                 const start = new Date(`1970-01-01T${document.getElementById('start-time').value}:00`);
                 const end = new Date(`1970-01-01T${document.getElementById('end-time').value}:00`);
                 let diffMs = end - start;
                 if (diffMs < 0) diffMs += 24 * 60 * 60 * 1000;
                 calculatedHours = diffMs / (1000 * 60 * 60);
            }
            const billingHours = Math.ceil(calculatedHours); 
            const daysCount = 1; // Assuming 1 day for simplicity of summary transfer

            let itemCost = price * qty * (unit.includes('hour') ? billingHours : daysCount);
            
            equipmentData.push({
                name: name,
                qty: qty,
                unit: unit,
                unitPrice: price,
                subtotal: itemCost 
            });
            totalEquipmentCost += itemCost;
        }
    });


    // 3. Collect Calculated Pricing (Requires calculateTotal() to run first!)
    // If you implemented the previous JavaScript correctly, calculateTotal() updates these:
    const basePriceText = document.getElementById('base-price-display').textContent.replace(/[₱,]/g, '').trim();
    const equipmentCostText = document.getElementById('equipment-cost-display').textContent.replace(/[₱,]/g, '').trim();
    const totalAmountText = document.getElementById('estimated-total-display').textContent.replace(/[₱,]/g, '').trim();
    
    // Attempt to parse out base cost and overage from the display
    let venueBasePrice = 0;
    let venueOverage = 0;
    if (basePriceText.includes('+')) {
        const parts = basePriceText.split('+').map(p => parseFloat(p.trim().split('(')[0]));
        venueBasePrice = parts[0] || 0;
        venueOverage = parts[1] || 0;
    } else {
        venueBasePrice = parseFloat(basePriceText) || 0;
    }
    
    // Use the values from the display, which were calculated by the script
    const pricingData = {
        venueBasePrice: venueBasePrice,
        venueOverage: venueOverage,
        totalEquipmentCost: parseFloat(equipmentCostText) || 0,
        // The total amount includes the 3000 deposit
        totalAmount: parseFloat(totalAmountText) || 3000, 
    };

    // 4. Combine and Save Data
    const fullReservationData = {
        contact: contactInfo,
        event: eventDetails,
        notes: notes,
        equipment: equipmentData,
        pricing: pricingData,
    };
    
    // Save to Local Storage
    localStorage.setItem('pgsoReservationData', JSON.stringify(fullReservationData));
    
    // Redirect to summary page
    window.location.href = 'summary.html';
}
        });
    </script>
    </body>
</html>